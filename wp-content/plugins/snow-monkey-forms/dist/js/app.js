(()=>{"use strict";const e=function(e,t){var r,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];try{r=new CustomEvent(t,{bubbles:n,cancelable:a,detail:s})}catch(e){(r=document.createEvent("CustomEvent")).initCustomEvent(t,n,a,s)}e.dispatchEvent(r)};function t(t){t.preventDefault();const r=t.target,s=r.querySelector(".smf-focus-point"),n=r.querySelector(".smf-form"),a=r.querySelector(".smf-action"),o=new FormData(r),c=a.querySelector('[data-clicked="true"]'),i=t.submitter||c,l=i?i.querySelector(".smf-sending"):void 0;l&&l.setAttribute("aria-hidden","false"),c&&c.removeAttribute("data-clicked");const m={status:"init",inputs:[].slice.call(r.querySelectorAll("input[name]:not([disabled]), textarea[name]:not([disabled]), select[name]:not([disabled])")).map((e=>{let t;return"checkbox"===e.type||"radio"===e.type?e.checked&&(t=e.value):t=e.value,void 0!==t&&{name:e.getAttribute("name"),value:t}})).filter((e=>e)),formData:o},d=e=>{n.innerHTML=e},u=e=>{a.innerHTML=e},f=()=>{s&&window.scrollTo(0,window.pageYOffset+s.getBoundingClientRect().top)},b=(s=null)=>{r.setAttribute("data-screen","systemerror");const n=document.createElement("div");n.classList.add("smf-system-error-content");const a=r.querySelector(".smf-system-error-content-ready");if(n.textContent=a.textContent,s){const e=document.createElement("br"),t=document.createElement("span");t.classList.add("smf-system-error-status-text"),t.textContent=`(status: ${s})`,n.appendChild(e),n.appendChild(t)}d(n.outerHTML),u(""),f(),m.status="systemerror",e(t.target,"smf.systemerror",m)};e(t.target,"smf.beforesubmit",m);const v=new XMLHttpRequest;v.onreadystatechange=()=>{4===v.readyState&&(200===v.status&&v.status?(s=>{if(l&&l.setAttribute("aria-hidden","true"),void 0===(s=JSON.parse(s)).method)return void b();const n=s.method;if(r.setAttribute("data-screen",n),u(s.action),[].slice.call(r.querySelectorAll(".smf-placeholder")).forEach((e=>{e.innerHTML=""})),(e=>""===e||"back"===e||"invalid"===e||"confirm"===e)(n)){(e=>{for(const t in e){const s=e[t];r.querySelector(`.smf-placeholder[data-name="${t}"]`).innerHTML=s}})(s.controls);const e=[].slice.call(r.querySelectorAll(".smf-error-messages"));0<e.length?(e=>{if(0<e.length){const t=((e,t)=>{for(let t=e;t;t=t.parentElement)if(t.classList.contains("smf-placeholder"))return t})(e[0]),r=!!t&&t.querySelector("input, select, textarea, button, .smf-file-control");r&&r.focus()}})(e):f()}else(e=>"complete"===e||"systemerror"===e)(n)?(d(s.message),f(),u(s.action)):(d(""),u(""));switch(m.status=n,m.status){case"back":e(t.target,"smf.back",m);break;case"confirm":e(t.target,"smf.confirm",m);break;case"complete":e(t.target,"smf.complete",m);break;case"invalid":e(t.target,"smf.invalid",m);break;case"systemerror":e(t.target,"smf.systemerror",m)}e(t.target,"smf.submit",m)})(JSON.parse(v.response)):b(v?.statusText))},v.open("POST",snowmonkeyforms.view_json_url,!0),v.send(o)}document.addEventListener("change",(e=>{const t=e.target;if(t.classList.contains("smf-file-control__control")){const e=t.parentNode.querySelector(".smf-file-control__filename"),r=t.files;if(0<r.length&&e){const t=r[0];void 0!==t.name&&(e.textContent=t.name)}}}),!1);const r=(e,t)=>{for(let r=e;r;r=r.parentElement)if(r.classList.contains(t))return r};document.addEventListener("click",(e=>{const t=e.target;if(t.getAttribute("data-action")&&t.setAttribute("data-clicked","true"),"back"===t.getAttribute("data-action")){const e=r(t,"smf-action");if(e){const t=e.querySelector('[type="hidden"][name="snow-monkey-forms-meta[method]"]');t&&t.setAttribute("value","back")}}}),!1),[].slice.call(document.querySelectorAll(".snow-monkey-form")).forEach((e=>{e.addEventListener("submit",t,!1)})),["change","keyup"].forEach((e=>{document.addEventListener(e,(e=>{const t=e.target;if("1"===t.getAttribute("data-invalid")){t.removeAttribute("data-invalid"),[].slice.call(t.querySelectorAll('[data-invalid="1"]')).forEach((e=>e.removeAttribute("data-invalid")));const e=r(t,"smf-placeholder");if(e){const t=e.querySelector(".smf-error-messages");t&&t.parentNode.removeChild(t)}}}),!1)}))})();